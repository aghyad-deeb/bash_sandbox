# Auto-generated docker-compose.yaml
# Generated with: python generate_compose.py --containers 128
#
# Usage:
#   docker compose up -d
#   docker compose logs -f session-server
#   curl http://localhost:8080/health

version: "3.8"

services:
  # Session server - manages all containers
  session-server:
    build:
      context: ../..
      dockerfile: docker/swerex-server/Dockerfile.server
    ports:
      - "8080:8080"
    environment:
      - SWEREX_ENDPOINTS=${SWEREX_ENDPOINTS:-http://swerex-0:8000,http://swerex-1:8000,http://swerex-2:8000,http://swerex-3:8000,http://swerex-4:8000,http://swerex-5:8000,http://swerex-6:8000,http://swerex-7:8000,http://swerex-8:8000,http://swerex-9:8000,http://swerex-10:8000,http://swerex-11:8000,http://swerex-12:8000,http://swerex-13:8000,http://swerex-14:8000,http://swerex-15:8000,http://swerex-16:8000,http://swerex-17:8000,http://swerex-18:8000,http://swerex-19:8000,http://swerex-20:8000,http://swerex-21:8000,http://swerex-22:8000,http://swerex-23:8000,http://swerex-24:8000,http://swerex-25:8000,http://swerex-26:8000,http://swerex-27:8000,http://swerex-28:8000,http://swerex-29:8000,http://swerex-30:8000,http://swerex-31:8000,http://swerex-32:8000,http://swerex-33:8000,http://swerex-34:8000,http://swerex-35:8000,http://swerex-36:8000,http://swerex-37:8000,http://swerex-38:8000,http://swerex-39:8000,http://swerex-40:8000,http://swerex-41:8000,http://swerex-42:8000,http://swerex-43:8000,http://swerex-44:8000,http://swerex-45:8000,http://swerex-46:8000,http://swerex-47:8000,http://swerex-48:8000,http://swerex-49:8000,http://swerex-50:8000,http://swerex-51:8000,http://swerex-52:8000,http://swerex-53:8000,http://swerex-54:8000,http://swerex-55:8000,http://swerex-56:8000,http://swerex-57:8000,http://swerex-58:8000,http://swerex-59:8000,http://swerex-60:8000,http://swerex-61:8000,http://swerex-62:8000,http://swerex-63:8000,http://swerex-64:8000,http://swerex-65:8000,http://swerex-66:8000,http://swerex-67:8000,http://swerex-68:8000,http://swerex-69:8000,http://swerex-70:8000,http://swerex-71:8000,http://swerex-72:8000,http://swerex-73:8000,http://swerex-74:8000,http://swerex-75:8000,http://swerex-76:8000,http://swerex-77:8000,http://swerex-78:8000,http://swerex-79:8000,http://swerex-80:8000,http://swerex-81:8000,http://swerex-82:8000,http://swerex-83:8000,http://swerex-84:8000,http://swerex-85:8000,http://swerex-86:8000,http://swerex-87:8000,http://swerex-88:8000,http://swerex-89:8000,http://swerex-90:8000,http://swerex-91:8000,http://swerex-92:8000,http://swerex-93:8000,http://swerex-94:8000,http://swerex-95:8000,http://swerex-96:8000,http://swerex-97:8000,http://swerex-98:8000,http://swerex-99:8000,http://swerex-100:8000,http://swerex-101:8000,http://swerex-102:8000,http://swerex-103:8000,http://swerex-104:8000,http://swerex-105:8000,http://swerex-106:8000,http://swerex-107:8000,http://swerex-108:8000,http://swerex-109:8000,http://swerex-110:8000,http://swerex-111:8000,http://swerex-112:8000,http://swerex-113:8000,http://swerex-114:8000,http://swerex-115:8000,http://swerex-116:8000,http://swerex-117:8000,http://swerex-118:8000,http://swerex-119:8000,http://swerex-120:8000,http://swerex-121:8000,http://swerex-122:8000,http://swerex-123:8000,http://swerex-124:8000,http://swerex-125:8000,http://swerex-126:8000,http://swerex-127:8000}
      - SWEREX_SESSIONS_PER_CONTAINER=${SWEREX_SESSIONS_PER_CONTAINER:-8}
      - SWEREX_AUTH_TOKEN=${SWEREX_AUTH_TOKEN:-default-token}
    depends_on:
      swerex-0:
        condition: service_healthy
      swerex-1:
        condition: service_healthy
      swerex-2:
        condition: service_healthy
      swerex-3:
        condition: service_healthy
      swerex-4:
        condition: service_healthy
      swerex-5:
        condition: service_healthy
      swerex-6:
        condition: service_healthy
      swerex-7:
        condition: service_healthy
      swerex-8:
        condition: service_healthy
      swerex-9:
        condition: service_healthy
      swerex-10:
        condition: service_healthy
      swerex-11:
        condition: service_healthy
      swerex-12:
        condition: service_healthy
      swerex-13:
        condition: service_healthy
      swerex-14:
        condition: service_healthy
      swerex-15:
        condition: service_healthy
      swerex-16:
        condition: service_healthy
      swerex-17:
        condition: service_healthy
      swerex-18:
        condition: service_healthy
      swerex-19:
        condition: service_healthy
      swerex-20:
        condition: service_healthy
      swerex-21:
        condition: service_healthy
      swerex-22:
        condition: service_healthy
      swerex-23:
        condition: service_healthy
      swerex-24:
        condition: service_healthy
      swerex-25:
        condition: service_healthy
      swerex-26:
        condition: service_healthy
      swerex-27:
        condition: service_healthy
      swerex-28:
        condition: service_healthy
      swerex-29:
        condition: service_healthy
      swerex-30:
        condition: service_healthy
      swerex-31:
        condition: service_healthy
      swerex-32:
        condition: service_healthy
      swerex-33:
        condition: service_healthy
      swerex-34:
        condition: service_healthy
      swerex-35:
        condition: service_healthy
      swerex-36:
        condition: service_healthy
      swerex-37:
        condition: service_healthy
      swerex-38:
        condition: service_healthy
      swerex-39:
        condition: service_healthy
      swerex-40:
        condition: service_healthy
      swerex-41:
        condition: service_healthy
      swerex-42:
        condition: service_healthy
      swerex-43:
        condition: service_healthy
      swerex-44:
        condition: service_healthy
      swerex-45:
        condition: service_healthy
      swerex-46:
        condition: service_healthy
      swerex-47:
        condition: service_healthy
      swerex-48:
        condition: service_healthy
      swerex-49:
        condition: service_healthy
      swerex-50:
        condition: service_healthy
      swerex-51:
        condition: service_healthy
      swerex-52:
        condition: service_healthy
      swerex-53:
        condition: service_healthy
      swerex-54:
        condition: service_healthy
      swerex-55:
        condition: service_healthy
      swerex-56:
        condition: service_healthy
      swerex-57:
        condition: service_healthy
      swerex-58:
        condition: service_healthy
      swerex-59:
        condition: service_healthy
      swerex-60:
        condition: service_healthy
      swerex-61:
        condition: service_healthy
      swerex-62:
        condition: service_healthy
      swerex-63:
        condition: service_healthy
      swerex-64:
        condition: service_healthy
      swerex-65:
        condition: service_healthy
      swerex-66:
        condition: service_healthy
      swerex-67:
        condition: service_healthy
      swerex-68:
        condition: service_healthy
      swerex-69:
        condition: service_healthy
      swerex-70:
        condition: service_healthy
      swerex-71:
        condition: service_healthy
      swerex-72:
        condition: service_healthy
      swerex-73:
        condition: service_healthy
      swerex-74:
        condition: service_healthy
      swerex-75:
        condition: service_healthy
      swerex-76:
        condition: service_healthy
      swerex-77:
        condition: service_healthy
      swerex-78:
        condition: service_healthy
      swerex-79:
        condition: service_healthy
      swerex-80:
        condition: service_healthy
      swerex-81:
        condition: service_healthy
      swerex-82:
        condition: service_healthy
      swerex-83:
        condition: service_healthy
      swerex-84:
        condition: service_healthy
      swerex-85:
        condition: service_healthy
      swerex-86:
        condition: service_healthy
      swerex-87:
        condition: service_healthy
      swerex-88:
        condition: service_healthy
      swerex-89:
        condition: service_healthy
      swerex-90:
        condition: service_healthy
      swerex-91:
        condition: service_healthy
      swerex-92:
        condition: service_healthy
      swerex-93:
        condition: service_healthy
      swerex-94:
        condition: service_healthy
      swerex-95:
        condition: service_healthy
      swerex-96:
        condition: service_healthy
      swerex-97:
        condition: service_healthy
      swerex-98:
        condition: service_healthy
      swerex-99:
        condition: service_healthy
      swerex-100:
        condition: service_healthy
      swerex-101:
        condition: service_healthy
      swerex-102:
        condition: service_healthy
      swerex-103:
        condition: service_healthy
      swerex-104:
        condition: service_healthy
      swerex-105:
        condition: service_healthy
      swerex-106:
        condition: service_healthy
      swerex-107:
        condition: service_healthy
      swerex-108:
        condition: service_healthy
      swerex-109:
        condition: service_healthy
      swerex-110:
        condition: service_healthy
      swerex-111:
        condition: service_healthy
      swerex-112:
        condition: service_healthy
      swerex-113:
        condition: service_healthy
      swerex-114:
        condition: service_healthy
      swerex-115:
        condition: service_healthy
      swerex-116:
        condition: service_healthy
      swerex-117:
        condition: service_healthy
      swerex-118:
        condition: service_healthy
      swerex-119:
        condition: service_healthy
      swerex-120:
        condition: service_healthy
      swerex-121:
        condition: service_healthy
      swerex-122:
        condition: service_healthy
      swerex-123:
        condition: service_healthy
      swerex-124:
        condition: service_healthy
      swerex-125:
        condition: service_healthy
      swerex-126:
        condition: service_healthy
      swerex-127:
        condition: service_healthy
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 10s
      timeout: 5s
      retries: 3
    restart: unless-stopped

  # Base swerex sandbox configuration
  swerex-base:
    image: swerex-sandbox:latest
    read_only: true
    tmpfs:
      - /tmp:size=500M,mode=1777
      - /root:size=100M
    environment:
      - AUTH_TOKEN=${SWEREX_AUTH_TOKEN:-default-token}
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 5s
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '1'
          memory: 1G

  swerex-0:
    extends:
      service: swerex-base
    ports:
      - "18000:8000"

  swerex-1:
    extends:
      service: swerex-base
    ports:
      - "18001:8000"

  swerex-2:
    extends:
      service: swerex-base
    ports:
      - "18002:8000"

  swerex-3:
    extends:
      service: swerex-base
    ports:
      - "18003:8000"

  swerex-4:
    extends:
      service: swerex-base
    ports:
      - "18004:8000"

  swerex-5:
    extends:
      service: swerex-base
    ports:
      - "18005:8000"

  swerex-6:
    extends:
      service: swerex-base
    ports:
      - "18006:8000"

  swerex-7:
    extends:
      service: swerex-base
    ports:
      - "18007:8000"

  swerex-8:
    extends:
      service: swerex-base
    ports:
      - "18008:8000"

  swerex-9:
    extends:
      service: swerex-base
    ports:
      - "18009:8000"

  swerex-10:
    extends:
      service: swerex-base
    ports:
      - "18010:8000"

  swerex-11:
    extends:
      service: swerex-base
    ports:
      - "18011:8000"

  swerex-12:
    extends:
      service: swerex-base
    ports:
      - "18012:8000"

  swerex-13:
    extends:
      service: swerex-base
    ports:
      - "18013:8000"

  swerex-14:
    extends:
      service: swerex-base
    ports:
      - "18014:8000"

  swerex-15:
    extends:
      service: swerex-base
    ports:
      - "18015:8000"

  swerex-16:
    extends:
      service: swerex-base
    ports:
      - "18016:8000"

  swerex-17:
    extends:
      service: swerex-base
    ports:
      - "18017:8000"

  swerex-18:
    extends:
      service: swerex-base
    ports:
      - "18018:8000"

  swerex-19:
    extends:
      service: swerex-base
    ports:
      - "18019:8000"

  swerex-20:
    extends:
      service: swerex-base
    ports:
      - "18020:8000"

  swerex-21:
    extends:
      service: swerex-base
    ports:
      - "18021:8000"

  swerex-22:
    extends:
      service: swerex-base
    ports:
      - "18022:8000"

  swerex-23:
    extends:
      service: swerex-base
    ports:
      - "18023:8000"

  swerex-24:
    extends:
      service: swerex-base
    ports:
      - "18024:8000"

  swerex-25:
    extends:
      service: swerex-base
    ports:
      - "18025:8000"

  swerex-26:
    extends:
      service: swerex-base
    ports:
      - "18026:8000"

  swerex-27:
    extends:
      service: swerex-base
    ports:
      - "18027:8000"

  swerex-28:
    extends:
      service: swerex-base
    ports:
      - "18028:8000"

  swerex-29:
    extends:
      service: swerex-base
    ports:
      - "18029:8000"

  swerex-30:
    extends:
      service: swerex-base
    ports:
      - "18030:8000"

  swerex-31:
    extends:
      service: swerex-base
    ports:
      - "18031:8000"

  swerex-32:
    extends:
      service: swerex-base
    ports:
      - "18032:8000"

  swerex-33:
    extends:
      service: swerex-base
    ports:
      - "18033:8000"

  swerex-34:
    extends:
      service: swerex-base
    ports:
      - "18034:8000"

  swerex-35:
    extends:
      service: swerex-base
    ports:
      - "18035:8000"

  swerex-36:
    extends:
      service: swerex-base
    ports:
      - "18036:8000"

  swerex-37:
    extends:
      service: swerex-base
    ports:
      - "18037:8000"

  swerex-38:
    extends:
      service: swerex-base
    ports:
      - "18038:8000"

  swerex-39:
    extends:
      service: swerex-base
    ports:
      - "18039:8000"

  swerex-40:
    extends:
      service: swerex-base
    ports:
      - "18040:8000"

  swerex-41:
    extends:
      service: swerex-base
    ports:
      - "18041:8000"

  swerex-42:
    extends:
      service: swerex-base
    ports:
      - "18042:8000"

  swerex-43:
    extends:
      service: swerex-base
    ports:
      - "18043:8000"

  swerex-44:
    extends:
      service: swerex-base
    ports:
      - "18044:8000"

  swerex-45:
    extends:
      service: swerex-base
    ports:
      - "18045:8000"

  swerex-46:
    extends:
      service: swerex-base
    ports:
      - "18046:8000"

  swerex-47:
    extends:
      service: swerex-base
    ports:
      - "18047:8000"

  swerex-48:
    extends:
      service: swerex-base
    ports:
      - "18048:8000"

  swerex-49:
    extends:
      service: swerex-base
    ports:
      - "18049:8000"

  swerex-50:
    extends:
      service: swerex-base
    ports:
      - "18050:8000"

  swerex-51:
    extends:
      service: swerex-base
    ports:
      - "18051:8000"

  swerex-52:
    extends:
      service: swerex-base
    ports:
      - "18052:8000"

  swerex-53:
    extends:
      service: swerex-base
    ports:
      - "18053:8000"

  swerex-54:
    extends:
      service: swerex-base
    ports:
      - "18054:8000"

  swerex-55:
    extends:
      service: swerex-base
    ports:
      - "18055:8000"

  swerex-56:
    extends:
      service: swerex-base
    ports:
      - "18056:8000"

  swerex-57:
    extends:
      service: swerex-base
    ports:
      - "18057:8000"

  swerex-58:
    extends:
      service: swerex-base
    ports:
      - "18058:8000"

  swerex-59:
    extends:
      service: swerex-base
    ports:
      - "18059:8000"

  swerex-60:
    extends:
      service: swerex-base
    ports:
      - "18060:8000"

  swerex-61:
    extends:
      service: swerex-base
    ports:
      - "18061:8000"

  swerex-62:
    extends:
      service: swerex-base
    ports:
      - "18062:8000"

  swerex-63:
    extends:
      service: swerex-base
    ports:
      - "18063:8000"

  swerex-64:
    extends:
      service: swerex-base
    ports:
      - "18064:8000"

  swerex-65:
    extends:
      service: swerex-base
    ports:
      - "18065:8000"

  swerex-66:
    extends:
      service: swerex-base
    ports:
      - "18066:8000"

  swerex-67:
    extends:
      service: swerex-base
    ports:
      - "18067:8000"

  swerex-68:
    extends:
      service: swerex-base
    ports:
      - "18068:8000"

  swerex-69:
    extends:
      service: swerex-base
    ports:
      - "18069:8000"

  swerex-70:
    extends:
      service: swerex-base
    ports:
      - "18070:8000"

  swerex-71:
    extends:
      service: swerex-base
    ports:
      - "18071:8000"

  swerex-72:
    extends:
      service: swerex-base
    ports:
      - "18072:8000"

  swerex-73:
    extends:
      service: swerex-base
    ports:
      - "18073:8000"

  swerex-74:
    extends:
      service: swerex-base
    ports:
      - "18074:8000"

  swerex-75:
    extends:
      service: swerex-base
    ports:
      - "18075:8000"

  swerex-76:
    extends:
      service: swerex-base
    ports:
      - "18076:8000"

  swerex-77:
    extends:
      service: swerex-base
    ports:
      - "18077:8000"

  swerex-78:
    extends:
      service: swerex-base
    ports:
      - "18078:8000"

  swerex-79:
    extends:
      service: swerex-base
    ports:
      - "18079:8000"

  swerex-80:
    extends:
      service: swerex-base
    ports:
      - "18080:8000"

  swerex-81:
    extends:
      service: swerex-base
    ports:
      - "18081:8000"

  swerex-82:
    extends:
      service: swerex-base
    ports:
      - "18082:8000"

  swerex-83:
    extends:
      service: swerex-base
    ports:
      - "18083:8000"

  swerex-84:
    extends:
      service: swerex-base
    ports:
      - "18084:8000"

  swerex-85:
    extends:
      service: swerex-base
    ports:
      - "18085:8000"

  swerex-86:
    extends:
      service: swerex-base
    ports:
      - "18086:8000"

  swerex-87:
    extends:
      service: swerex-base
    ports:
      - "18087:8000"

  swerex-88:
    extends:
      service: swerex-base
    ports:
      - "18088:8000"

  swerex-89:
    extends:
      service: swerex-base
    ports:
      - "18089:8000"

  swerex-90:
    extends:
      service: swerex-base
    ports:
      - "18090:8000"

  swerex-91:
    extends:
      service: swerex-base
    ports:
      - "18091:8000"

  swerex-92:
    extends:
      service: swerex-base
    ports:
      - "18092:8000"

  swerex-93:
    extends:
      service: swerex-base
    ports:
      - "18093:8000"

  swerex-94:
    extends:
      service: swerex-base
    ports:
      - "18094:8000"

  swerex-95:
    extends:
      service: swerex-base
    ports:
      - "18095:8000"

  swerex-96:
    extends:
      service: swerex-base
    ports:
      - "18096:8000"

  swerex-97:
    extends:
      service: swerex-base
    ports:
      - "18097:8000"

  swerex-98:
    extends:
      service: swerex-base
    ports:
      - "18098:8000"

  swerex-99:
    extends:
      service: swerex-base
    ports:
      - "18099:8000"

  swerex-100:
    extends:
      service: swerex-base
    ports:
      - "18100:8000"

  swerex-101:
    extends:
      service: swerex-base
    ports:
      - "18101:8000"

  swerex-102:
    extends:
      service: swerex-base
    ports:
      - "18102:8000"

  swerex-103:
    extends:
      service: swerex-base
    ports:
      - "18103:8000"

  swerex-104:
    extends:
      service: swerex-base
    ports:
      - "18104:8000"

  swerex-105:
    extends:
      service: swerex-base
    ports:
      - "18105:8000"

  swerex-106:
    extends:
      service: swerex-base
    ports:
      - "18106:8000"

  swerex-107:
    extends:
      service: swerex-base
    ports:
      - "18107:8000"

  swerex-108:
    extends:
      service: swerex-base
    ports:
      - "18108:8000"

  swerex-109:
    extends:
      service: swerex-base
    ports:
      - "18109:8000"

  swerex-110:
    extends:
      service: swerex-base
    ports:
      - "18110:8000"

  swerex-111:
    extends:
      service: swerex-base
    ports:
      - "18111:8000"

  swerex-112:
    extends:
      service: swerex-base
    ports:
      - "18112:8000"

  swerex-113:
    extends:
      service: swerex-base
    ports:
      - "18113:8000"

  swerex-114:
    extends:
      service: swerex-base
    ports:
      - "18114:8000"

  swerex-115:
    extends:
      service: swerex-base
    ports:
      - "18115:8000"

  swerex-116:
    extends:
      service: swerex-base
    ports:
      - "18116:8000"

  swerex-117:
    extends:
      service: swerex-base
    ports:
      - "18117:8000"

  swerex-118:
    extends:
      service: swerex-base
    ports:
      - "18118:8000"

  swerex-119:
    extends:
      service: swerex-base
    ports:
      - "18119:8000"

  swerex-120:
    extends:
      service: swerex-base
    ports:
      - "18120:8000"

  swerex-121:
    extends:
      service: swerex-base
    ports:
      - "18121:8000"

  swerex-122:
    extends:
      service: swerex-base
    ports:
      - "18122:8000"

  swerex-123:
    extends:
      service: swerex-base
    ports:
      - "18123:8000"

  swerex-124:
    extends:
      service: swerex-base
    ports:
      - "18124:8000"

  swerex-125:
    extends:
      service: swerex-base
    ports:
      - "18125:8000"

  swerex-126:
    extends:
      service: swerex-base
    ports:
      - "18126:8000"

  swerex-127:
    extends:
      service: swerex-base
    ports:
      - "18127:8000"
